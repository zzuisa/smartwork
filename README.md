# smartwork

#### ✏ 功能描述:

基于工作日志导出**月底交付件报表** `V 1.3.1`



#### 📌更新明细：

| 版本号    | 修改内容                                                     |
| --------- | ------------------------------------------------------------ |
| `V 1.0`   | 项目初始化 V1.0                                              |
| `V 1.0.1` | 添加手动调整指定月份，修改Readme.md，修复bug：无法存储多月份的统计信息 |
| `V 1.1.0` | 新增同时导出交付件功能 V1.1.0                                |
| `V 1.2.0` | 导出报告格式修改，新增Header项，配置项等 V1.2.0              |
| `V 1.2.1` | 修改文本匹配算法，匹配备注，调整文档格式                     |
| `V 1.3.0` | 项目结构解耦，优化文本匹配，修复部分偶现bug，微调文档格式，其他细节微调 V1.3.0 |
| `V 1.3.1` | 新增：可选择是否导出最简表格功能 <br />修复: 导出表格中显示日期格式错误的bug <br />调整: 单元格格式完全按照在线文档格式 <br />https://onebox.huawei.com/v/58510f00337cd8f5697f440fbb0fdc30?type=1 |



#### 📋 Requirements:

> python==3.8.8

openpyxl==3.0.10
pandas==1.4.4
et-xmlfile==1.1.0
numpy==1.23.3
tqdm==4.64.1

#### 👀 Preview:

```bash
$ python ./main.py 
搜索中: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:00<00:00, 3577.25it/s]
[processed_data] {
    "事件": 0,
    "故障": 0,
    "PM": 0,
    "告警": 2,
    "变更": 5,
    "变更评审": 3,
    "主动运维": 39,
    "FAQ": 0,
    "负向事件": 0
} TO D:\workspace\0交付件\2022交付件.xlsx  => [09月]
    "外部单号": "R01941805",
    "业务系统": "CBG Myhuawei",
    "应用模块": "Forum",
    "问题发现时间": "2022/09/28",
    "问题处理时长": 2,
    "状态": "Closed",
    "问题分类": "变更实施",
    "问题描述": "海外社区club实施变更",
    "根因分析": "wangyifei 00504091 club 德电\n 部分站点表结构错误，重建库表，刷数据（配置表）。\n",
    "国家": "新加坡",
    "责任人": "孙奥",
    "备注": "测试：土耳其站点接口报错，后来开发在跟测试联调，待确认结果",
    "问题大类": "操作类"
} TO D:\workspace\0交付件\2022交付件.xlsx => [09月-交付件]
```

| 事件 | 故障 | PM   | 告警 | 变更 | 变更评审 | 主动运维 | FAQ  | 负向事件 |
| ---- | ---- | ---- | ---- | ---- | -------- | -------- | ---- | -------- |
| 0    | 0    | 0    | 2    | 3    | 3        | 39       | 0    | 0        |

| 外部单号  | 业务系统     | 应用模块   | 问题发现时间 | 问题处理时长 | 状态   | 问题分类 | 问题描述      | 根因分析                                                     | 国家   | 责任人 | 备注                                                         | 问题大类 |
| --------- | ------------ | ---------- | ------------ | ------------ | ------ | -------- | ------------- | ------------------------------------------------------------ | ------ | ------ | ------------------------------------------------------------ | -------- |
| R01941735 | CBG Myhuawei | 服务化中台 | 2022/09/28   | 4            | Closed | 变更实施 | 服务中台forum | zhaojianyang 30001833 forum  新加坡、俄罗斯、德电     拉、推镜像，升级cce     刷数据库脚本     查日志，协助debug     测试成功 | 新加坡 | 孙奥   | https://eops.huawei.com/octopusportal/#!octopusportal/exception/viewException.html?envType=pro&taskId=1941735&approveNode=13 | 操作类   |

**注:** *不同月份的数据会分布在如下命名格式的工作簿(sheet)中。*

[indicators]|[9月]|[9月交付件]|[10月]|[10月交付件]