# smartwork

#### ✏ 功能描述:

基于工作日志导出**月底交付件报表** `V 1.3.0`



#### 📌更新明细：

| 版本号    | 修改内容                                                     |
| --------- | ------------------------------------------------------------ |
| `V 1.0`   | 项目初始化                                                   |
| `V 1.0.1` | 添加手动调整指定月份，修改Readme.md，修复bug：无法存储多月份的统计信息 |
| `V 1.1.0` | 新增同时导出交付件功能                                       |
| `V 1.2.0` | 导出报告格式修改，新增Header项目，配置项等 V1.2.0            |
| `V 1.2.1` | 修改文本匹配算法，匹配备注，调整文档格式 V1.2.1              |
| `V 1.3.0` | 项目结构解耦，优化文本匹配，修复部分偶现bug，微调文档格式，其他细节微调 V1.3.0 |



#### 📋 Requirements:

> python==3.8.8

openpyxl==3.0.10
pandas==1.4.4
et-xmlfile==1.1.0
numpy==1.23.3
tqdm==4.64.1

#### 👀 Preview:

```bash
$ python ./main.py 
搜索中: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:00<00:00, 3577.25it/s]
[processed_data] {
    "事件": 0,
    "故障": 0,
    "PM": 0,
    "告警": 2,
    "变更": 3,
    "变更评审": 3,
    "主动运维": 39,
    "FAQ": 0,
    "负向事件": 0
} TO D:\workspace\0交付件\2022交付件.xlsx  => [09月]
    "外部单号": "R01941805",
    "业务系统": "CBG Myhuawei",
    "应用模块": "Forum",
    "问题发现时间": "2022/09/05",
    "问题处理时长": 2,
    "状态": "Closed",
    "问题分类": "变更实施",
    "问题描述": "海外社区实施变更",
    "根因分析": "club-配置文件0905.zip。\n",
    "国家": "新加坡",
    "责任人": "孙奥",
    "备注": "",
    "问题大类": "操作类"
} TO D:\workspace\0交付件\2022交付件.xlsx => [09月-交付件]
```

| 事件 | 故障 | PM   | 告警 | 变更 | 变更评审 | 主动运维 | FAQ  | 负向事件 |
| ---- | ---- | ---- | ---- | ---- | -------- | -------- | ---- | -------- |
| 0    | 0    | 0    | 2    | 3    | 3        | 39       | 0    | 0        |

| 外部单号 | 业务系统     | 应用模块 | 问题发现时间 | 问题处理时长 | 状态   | 问题分类 | 问题描述              | 根因分析                                                     | 国家   | 责任人 | 备注 | 问题大类 |
| -------- | ------------ | -------- | ------------ | ------------ | ------ | -------- | --------------------- | ------------------------------------------------------------ | ------ | ------ | ---- | -------- |
|          | CBG Myhuawei | Forum    | 2022/09/02   | 2            | Closed | 资源管理 | sg-auto自动化巡检项目 | 完成cce模块的适配：     相比于ECS，headers中需要添加：cftk     并且请求返回的数据格式与ECS差异较大，故分为另一个类别。     重构项目结构，规范代码，优化工具类。     进展 展示开会讨论下一步动作。     目前适配资源类型：elb、nginx、cce、mysql、redis | 新加坡 | 孙奥   |      | 操作类   |

**注:** *不同月份的数据会分布在如下命名格式的工作簿(sheet)中。*

[indicators]|[9月]|[9月交付件]|[10月]|[10月交付件]